trust ~ prosociality ),
CuskleyLoreto2016 = c(
proportion.of.adult.learners ~ type/token.ratio,
type/token.ratio ~ morphological.learning.strategy,
morphological.learning.strategy ~ verb.regularity,
verb.regularity ~ morphological.complexity ),
SzámadóSzathmáry2006 = c(
imitation ~ language,
language ~ cumulative.culture + division.of.labour,
acquisition.of.word.segmentation ~ language ),
Cuthbertson2016 = c(
imitation ~ transmission.error ),
Driem2005 = c(
language ~ brain.size.neocortex ),
Corballis2003 = c(
gesture.hand.gesturing ~ gestural.communication,
brain.size ~ gesture.hand.gesturing ),
LupyanDale2010 = c(
proportion.of.adult.learners ~ learning.cost.morphology,
population.size ~ population.contact + proportion.of.adult.learners,
learning.cost.morphology ~ morphological.complexity,
population.contact ~ learning.cost.morphology ),
DunbarGowlett2014 = c(
social.interaction ~ storytelling + gossip ),
Bednarik1997 = c(
voluntary.vocal.control ~ language,
language ~ hunting ),
ShawWilliams2017 = c(
protolanguage ~ language ),
RavivMeyerLevAri2018 = c(
population.size ~ compositionality + shared.language + morphological.complexity,
shared.language ~ linguistic.variation.between.groups,
compositionality ~ linguistic.variation.between.groups,
morphological.complexity ~ linguistic.variation.between.groups ),
ArbibLiebalPika2008 = c(
gestural.communication ~ protolanguage ),
TomaselloMelisTennieWymanetal2012 = c(
division.of.labour ~ collective.knowledge,
collaborations ~ group.identity,
group.identity ~ collective.intentionality,
collective.knowledge ~ collaborations ),
Okanoya2007 = c(
social.interaction ~ cooperation + communicative.interaction ),
GarciaGarasSchweitzer2012 = c(
lexicon.valence ~ lexicon.frequency.of.use + prosociality ),
RudnickiBackerDeclerck2018 = c(
alliances ~ cooperation,
gossip ~ alliances,
prosociality ~ alliances ),
HonkolaRuokolainenSyrjänenLeinoetal2018 = c(
cultural.adaptation ~ group.boundary.formation,
group.boundary.formation ~ population.contact ),
DallAstaBaronchelliBarratLoreto2006 = c(
population.size ~ shared.language ),
BentzBerdicevskis2016 = c(
age.of.language.acquisition ~ amount.of.linguistic.input,
amount.of.linguistic.input ~ morphological.complexity + morphological.complexity,
population.size ~ proportion.of.adult.learners,
proportion.of.adult.learners ~ age.of.language.acquisition ),
AtkinsonKirbySmith2015 = c(
acquisition.of.word.segmentation ~ acquisition.of.morphology,
acquisition.of.morphology ~ morphological.complexity,
population.size ~ number.of.speaker.models ),
Sapir1931 = c(
population.size ~ radius.of.communication ),
Planer2017 = c(
syntax ~ protolanguage + protolanguage,
protolanguage ~ collaborations + raw.material.transport.large.distances + language ),
BentzWinter2013 = c(
proportion.of.adult.learners ~ morphological.complexity ),
BoucherOsgood1969 = c(
lexicon.valence ~ lexicon.frequency.of.use,
positive.attitude ~ lexicon.valence,
social.interaction ~ positive.attitude ),
ArdellAndersonWinter2016 = c(
variation.phonetic ~ morphological.complexity,
population.size ~ variation.phonetic ),
GriesserWheatcroftSuzuki2018 = c(
compositionality ~ language ),
Nettle2012 = c(
population.size ~ proportion.of.adult.learners ),
Vogt2007 = c(
compositionality ~ shared.language,
population.size ~ compositionality ),
DediuLevinson2018 = c(
motor.control ~ language,
language ~ culture,
culture ~ cultural.adaptation ),
Dunbar2017 = c(
storytelling ~ social.interaction,
fire.control ~ social.interaction ),
Bowern2010 = c(
proportion.of.adult.learners ~ morphological.complexity,
food.storage ~ labor.specialization + population.size,
labor.specialization ~ social.complexity ),
Killin2017 = c(
protolanguage.multi-modal ~ foraging.strategy + fire.control ),
Wiessner2014 = c(
cooking ~ sociality,
sociality.nighttime ~ storytelling,
fire.control ~ cooking ),
Asano2016 = c(
motor.control ~ music ),
ChenChenMeindl1998 = c(
group.identity ~ cooperation,
trust ~ cooperation ),
McBride2014 = c(
storytelling ~ language ),
RealiChaterChristiansen2018 = c(
population.size ~ diffusion.of.innovations ),
MorganUominiRendellChouinardThulyetal2015 = c(
language ~ tool.making ),
BerwickOkanoyaBeckersBolhuis2011 = c(
sensorimotor.perception ~ acoustic.perception ),
NobleDavidson1991 = c(
language ~ hunting ),
TinitsNölleHartmann2017 = c(
transmission.error ~ morphological.complexity ),
Fitch2018 = c(
syntax ~ language ),
Hurford2018 = c(
brain.size.neocortex ~ cooperation )
)
sample(1:978,3)
library("ggplot")
library("ggplot2")
library("RSQLite")
install.packages("RSQLite")
library(ggplot2)
install.packages("RSQLite")
install.packages("RSQLite")
library(RSQLite)
d = read.csv("~/Documents/Bristol/Admin/Representation/Pathway2.csv")
d[grepl("School of Arts",d$Org.Div.Dept.Split),]
x = d[grepl("School of Arts",d$Org.Div.Dept.Split),]
paste(x$Known.As,x$Surname,x$Email.Name)
paste(x$Known.As,x$Surname,"(",x$Email.Name,")")
d = read.csv("~/Downloads/vini_all.csv",stringsAsFactors = F)
d$repairInitiation
unique(d$repairInitiation)
unique(d$)
d
unique(d$)
unique(d$repairInitiation)
table(d$repairInitiation)
d = read.csv("~/Downloads/vini_all.csv",stringsAsFactors = F)
d[d$repairInitiation=="OFER",]$repairInitiation = "OFFER"
d[d$repairInitiation=="OC",]$repairInitiation = "OPEN"
table(d$repairInitiation)
table(d$repairInitiation,d$condition)
table(d$repairInitiation,d$condition,d$modality)
unique(d$modality)
table(d$condition,d$modality)
unique(d$dyadNumber)
d[d$dyadNumber=="",]
dx = read.csv("~/Documents/MPI/ViniciusMultimodal/multimodalCommunicationGame/experiment/data/Final_Turn_data.csv")
dim(dx)
dim(d)
dx = read.csv("~/Documents/MPI/ViniciusMultimodal/multimodalCommunicationGame/experiment/data/Final_Turn_data.csv")
tapply(dx$filename,dx$dyadNumber,head,n=1)
dx = read.csv("~/Documents/MPI/ViniciusMultimodal/multimodalCommunicationGame/experiment/data/Final_Turn_data.csv",stringsAsFactors = F)
tapply(dx$filename,dx$dyadNumber,head,n=1)
f[d$filename]
f = tapply(dx$filename,dx$dyadNumber,head,n=1)
dx = read.csv("~/Documents/MPI/ViniciusMultimodal/multimodalCommunicationGame/experiment/data/Final_Turn_data.csv",stringsAsFactors = F)
f = tapply(dx$filename,dx$dyadNumber,head,n=1)
d = read.csv("~/Downloads/vini_all.csv",stringsAsFactors = F)
d[d$repairInitiation=="OFER",]$repairInitiation = "OFFER"
d[d$repairInitiation=="OC",]$repairInitiation = "OPEN"
d[d$modality=="Mulit",]$modality = "Multi"
d$modalityCondition = f[d$filename]
table(d$repairInitiation,d$condition,d$modality)
f[d$filename]
head(d$filename)
f
f[d$filename[1]]
d$filename[1]
names(f)
d$dyadNumber
f[d$dyadNumber]
d$modalityCondition = f[d$dyadNumber]
table(d$repairInitiation,d$condition,d$modalityCondition)
table(d$repairInitiation,d$condition,d$modalityCondition)
f = tapply(dx$modalityCondition,dx$dyadNumber,head,n=1)
f
dx = read.csv("~/Documents/MPI/ViniciusMultimodal/multimodalCommunicationGame/experiment/data/Final_Turn_data.csv",stringsAsFactors = F)
f = tapply(dx$modalityCondition,dx$dyadNumber,head,n=1)
d = read.csv("~/Downloads/vini_all.csv",stringsAsFactors = F)
d[d$repairInitiation=="OFER",]$repairInitiation = "OFFER"
d[d$repairInitiation=="OC",]$repairInitiation = "OPEN"
d[d$modality=="Mulit",]$modality = "Multi"
d$modalityCondition = f[d$dyadNumber]
table(d$repairInitiation,d$condition,d$modalityCondition)
d$modalityCondition
table(d$modalityCondition)
table(d$repairInitiation,d$condition,d$modalityCondition)
table(d$repairInitiation,d$modalityCondition)
prop.table(x)
x = table(d$repairInitiation,d$modalityCondition)
prop.table(x)
prop.table(x,margin = 2)
dx = read.csv("~/Documents/MPI/ViniciusMultimodal/multimodalCommunicationGame/experiment/data/Final_Turn_data.csv",stringsAsFactors = F)
f = tapply(dx$modalityCondition,dx$dyadNumber,head,n=1)
d = read.csv("~/Downloads/vini_all.csv",stringsAsFactors = F)
d[d$repairInitiation=="OFER",]$repairInitiation = "OFFER"
d[d$repairInitiation=="OC",]$repairInitiation = "OPEN"
d[d$modality=="Mulit",]$modality = "Multi"
d = d[!is.na(d$repairInitiation),]
d = d[d$repairInitiation!="",]
d$modalityCondition = f[d$dyadNumber]
x = table(d$repairInitiation,d$modalityCondition)
prop.table(x,margin = 2)
x = table(d$repairInitiation,d$modalityCondition,d$condition)
prop.table(x,margin = 2)
table(d$repairInitiation,d$modalityCondition,d$condition)
x = table(d$repairInitiation,d$modalityCondition,d$condition)
prop.table(x,margin = 2)
prop.table(x,margin = 3)
x = table(d$repairInitiation,d$modalityCondition,d$condition)
x
x[1,,]
x[,,1]
prop.table(x[,,1],2)
# Auditory
prop.table(x[,,2],2)
# Auditory
prop.table(x[,1,],2)
x = table(d$repairInitiation,d$modalityCondition,d$condition)
# Auditory
prop.table(x[,1,],2)
# Auditory
prop.table(x[,2,],2)
dim(d)
d$repairInitiation
library(ggplot2)
?geom_boxplot
try(setwd("~/Documents/Bristol/FTRHumanCapital/FTRHumanCapital/analysis/"))
library(lavaan)
library(lavaan.survey)
library(semPlot)
library(lme4)
d = readRDS("../data/Feldmann/Feldmann_individual_level_data_min.RDS")
# Autonomous index
#V19= Important Child Qualities: Religious Faith
#V21= Important Child Qualities: Obedience
#V12= Important Child Qualities: Independence
#V18= Important Child Qualities: Determination, Perseverance
# Y003 Autonomy Index
#-2-.- Obedience/Religious Faith
#-1-.- -1
#0.- 0
#1.- 1
#2.- Determination, perseverance/Independence
#-5-.- Missing
#G023	I see myself as an autonomous individual
# Labels:
#   value               label
# -5    Missing; Unknown
# -4 Not asked in survey
# -3      Not applicable
# -2           No answer
# -1          Don´t know
# 1      Strongly agree
# 2               Agree
# 3            Disagree
# 4   Strongly disagree
#H006_02	Worries: Not being able to give one's children a good education
# Labels:
#   value               label
# -5     Missing;Unknown
# -4 Not asked in survey
# -3      Not applicable
# -2           No answer
# -1          Don´t know
# 1           Very much
# 2        A great deal
# 3            Not much
# 4          Not at all
#D060	University is more important for a boy than for a girl
# Labels:
#   value               label
# -5    Missing; Unknown
# -4 Not asked in survey
# -3      Not applicable
# -2           No answer
# -1          Don´t know
# 1      Agree strongly
# 2               Agree
# 3            Disagree
# 4   Strongly disagree
names(d)[names(d)=="Y003"] = "autonomyIndex"
names(d)[names(d)=="G023"] = "autonomousIndividual"
names(d)[names(d)=="H006_02"] = "worryChildEducation"
names(d)[names(d)=="D060"] = "univBoyVGirl"
d$autonomousIndividual[d$autonomousIndividual<0] = NA
d = d[complete.cases(d[,c("autonomyIndex","autonomousIndividual","worryChildEducation","univBoyVGirl",'PrDrop',"SecTerEdu")]),]
d = d[!is.na(d$languageFamily),]
d = d[!d$languageFamily %in% c("Koreanic","Austroasiatic","Aymaran","Abkhaz-Adyge","Nakh-Daghestanian","Quechuan"),]
# (autonomyIndex is already filtered for NA)
d = d[d$autonomousIndividual>=0,]
d = d[d$worryChildEducation>=0,]
d = d[d$worryChildEducation>=0,]
d = d[d$univBoyVGirl>=0,]
# Flip autonomous individual value so that high = individual.
d$autonomousIndividual = 2 - d$autonomousIndividual
# Language family dummies
#d$languageFamily = gsub("\\-","",d$languageFamily)
#lf = unique(d$languageFamily)
#for(f in lf[lf!="Koreanic"]){
#  d[,paste0("LF_",f)] = as.numeric(d$languageFamily==f)
#}
#langFamFactors = paste(paste0("LF_",lf[!lf %in% c("Koreanic","Austroasiatic","Aymaran","NakhDaghestanian","Quechuan","Dravidian")]),collapse = " + ")
#langFamFactors = paste(c("LF_IndoEuropean","LF_AfroAsiatic"),collapse=" + ")
coreControlVars = c("Town","White","SoClass",
"Protest","RomCath","EastOrth","OChrist",
"Jew","Musl","Hindu","Buddh","OEastRel",
"ORel","Age","Age_sq")
extraControlVars = c("Income","Empl","Unempl","Health",
"Married","LivTog","Divor","Separ",
"Widow","Children")
proDropModel = lmer(autonomyIndex ~ 1 + PrDrop +
(1|languageFamily)+(1|languageArea),
data = d)
d$PrDrop.resid = resid(proDropModel)
#+ Protest + RomCath + EastOrth + OChrist + Jew + Musl + Hindu + Buddh
model = "
Individualism =~ autonomyIndex + autonomousIndividual
AttitudeToEducation =~ worryChildEducation + univBoyVGirl
Individualism ~ PrDrop
AttitudeToEducation ~ Individualism +  Income + Female
SecTerEdu ~ AttitudeToEducation + Age + Female + Town + SoClass
"
fit <- sem(model, data=d)
summary(fit, standardized=TRUE)
semPaths(fit,residuals=F)
semPaths(fit, 'std',residuals=F,intercepts=F,exoVar=F,exoCov=T,nCharNodes=11,sizeMan=8,shapeMan="rectangle")
install.packages("lavaan")
---
title: "Matched sample E10, E11 and E12"
output: pdf_document
---
```{r echo=F,eval=F}
setwd("~/Documents/Conferences/Evolang12/genderBias2018_public/analysis/")
```
Load libraries and extra plotting functions.
```{r, warning=F,message=F}
library(ggplot2)
library(lme4)
source("SplitViolinPlot.R")
library(tidyr)
library(lavaan)
library(semPlot)
library (scales)
```
Load the data. Note that the submitted analysis also includes data on student status, though this data is not included in the public release because it makes the data identifiable.
```{r}
# Load the public data
allC = read.csv("../data/MatchedAuthors_E10_E11_E12.csv")
# Attempt to load the prive data
try(allC <- read.csv("../../genderBias2018/data/MatchedAuthors_E10_E11_E12_withStudent.csv"))
allC.long = allC %>% gather(conference,Score.mean,2:4)
allC.long$format = allC.long$E10.format
allC.long[allC.long$conference=="E11",]$format =
allC.long[allC.long$conference=="E11",]$E11.format
allC.long[allC.long$conference=="E12",]$format =
allC.long[allC.long$conference=="E11",]$E12.format
```
```{r}
gx = ggplot(allC.long,
aes(conference, Score.mean, fill=gender)) +
annotate("text", x = c(1,2.5), y = c(1.05,1.05),
label=c("Single-Blind", "Double-Blind"), size=6) +
geom_split_violin() +
geom_vline(xintercept=1.5) +
scale_y_continuous(name="Score ranking", breaks = c(0,0.25,0.5,0.75,1))+
scale_x_discrete(name="Conference")+
scale_fill_grey(start = 0.55, end=0.8,name="First Author Gender") +
geom_boxplot(width=0.2, show.legend = F) +
theme(legend.position = "top",
panel.grid.major.x = element_blank())
gx
pdf("../results/MatchedSamples.pdf",
height=5,width=6)
gx
dev.off()
```
\newpage
Fit a mixed effects model with random intercepts for author. The key question is whether there is an interaction between gender and review Type.
```{r}
contrasts(allC.long$gender) <- contr.sum(2)/2
contrasts(allC.long$format) <- contr.sum(2)/2
allC.long$reviewType =
as.factor(c("Single","Double")[
1+(allC.long$conference %in% c("E11","E12"))])
contrasts(allC.long$reviewType) <- contr.sum(2)/2
m0 = lmer(scale(Score.mean)~ 1 +
format +
(1|authorCode),
data = allC.long)
# Check if review type needs a random slope
mRevRan = update(m0,~.+(0+reviewType|authorCode))
anova(m0,mRevRan)
#No
# Add variales
mGen = update(m0,~.+gender)
anova(m0,mGen)
mGenXFormat = update(mGen,~.+gender:format)
anova(mGen,mGenXFormat)
mRev = update(mGenXFormat,~.+reviewType)
anova(mGen,mRev)
mGenxRev = update(mRev,~.+gender:reviewType)
anova(mRev,mGenxRev)
```
Significant effect of gender (in this sample, female authors tend to receive better scores overall than males).  As in the full sample, abstracts receive higher scores than papers.  There is no significant interaction between gender and review type.
\newpage
Plot individual data:
```{r}
ggplot(allC.long,
aes(y=Score.mean,
x=conference,
group=authorCode,
colour=authorCode)) +
geom_line() + theme(legend.position = 'none')
ggplot(allC.long,
aes(y=Score.mean,
x=conference,
group=authorCode,
colour=gender)) +
geom_line()
```
Plot improvement from E10 to E11 against improvement from E11 to E12.
```{r}
ggplot(allC, aes(x=diff.E10.to.E11,y=diff.E11.to.E12,colour=gender)) + geom_point() +
xlab("Change from E11 to E12") +
ylab("Change from E10 to E11")
```
This seems to suggest that researchers who improved from E10 to E11 tended to do worse going from E11 to E12. There seems to be no effect of gender on this relationship:
```{r}
contrasts(allC$gender) <- contr.sum(2)/2
summary(lm(diff.E11.to.E12~diff.E10.to.E11*gender,
data=allC))
```
There's also a positive relationship between improvement from E10 to E11 and the difference between E12 and E10. i.e. if you improved from E10 to E11, then you will have improved from E10 to E12.
```{r}
ggplot(allC, aes(x=diff.E10.to.E11,y=E12-E10,colour=gender)) + geom_point() +
xlab("Change from E11 to E12") +
ylab("Change from E10 to E11")
```
Only 10\% of researchers improve year on year:
```{r}
table((allC$E10 < allC$E11) & (allC$E11 < allC$E12))
```
\newpage
# Causal approach
In the analysis below, we use a structural equation model based on the hypothesised causal structure of the data.
Part of the reason for doing this is that submission format varies with gender. Because abstracts are more likely to be given higher scores than papers in general, this might be confounding the effect of gender.  Below is a graph created from the whole data (not just the matched samples):
```{r}
allData = read.csv("../data/EvoLang_Scores_8_to_12.csv",stringsAsFactors = F)
# relabel factor
allData$FirstAuthorGender = factor(allData$FirstAuthorGender,labels=c("F","M"))
allData$review = factor(c("Single","Double")[(allData$conference %in% c("E11","E12"))+1])
allData$conference = factor(allData$conference,levels = c("E8","E9","E10","E11","E12"))
allData$format = factor(allData$format)
ggplot(allData, aes(FirstAuthorGender)) +
geom_bar(aes(fill=format), position = "fill") +
scale_y_continuous(labels = percent_format())+
facet_grid(~conference) +
theme(legend.position = "top")
```
From the raw distribution, we see that male authors are more likely to submit a paper than female authors (though this trend varies by conference).
\newpage
In the structural equation model, we assume that:
-  The author's score for one conference has an impact on the score in the following year.
-  The author's choice of submission format in a given year influences the score (independently for that year).
-  The author's gender influences which format they submit.
-  The author's gender affects the score in E10 (single blind review)
-  The author's gender does not affect the score in E11 nor E12 (double blind reivew), but we estimate a correlation.
```{r}
allC$gender.F = allC$gender=="F"
allC$E10.abstract = allC$E10.format=="Abstract"
allC$E11.abstract = allC$E11.format=="Abstract"
allC$E12.abstract = allC$E12.format=="Abstract"
model = "
E12 ~ E11
E11 ~ E10
E10 ~ NA*E10.abstract + gender.F
E11 ~ E11.abstract
E11 ~~ gender.F
E12 ~ E12.abstract
E12 ~~ gender.F
E10.abstract ~ gender.F
E11.abstract ~ gender.F
E12.abstract ~ gender.F
"
fit <- sem(model, data=allC)
summary(fit, standardized=T)
```
Plots:
```{r fig.height=3}
layout = matrix(c(
1,6,  1,4,  1,2,  2,1,  2,3,  2,5,  3,3),
ncol=2,byrow = T)
layout = layout[,2:1]
```
Model:
```{r}
semPaths(fit,nCharNodes = 11,layout=layout)
fit@ParTable
fit@Model
fit@Model@dimNames
fit@Model@dimNames[[1]]
fit@Model@dimNames[[1]][[1]]
